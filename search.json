[{"path":"https://ncahill89.github.io/EIVmodels/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 EIVmodels authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://ncahill89.github.io/EIVmodels/articles/CPTutorial.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Bayesian Errors-in-Variables Change-Point Linear Regression","text":"going give starting point fitting Bayesian errors--variables, change-point regression model unevenly spaced time series data, assuming single change point measurement errors. ’ll start simulating data known change point ’ll see change-point model can detect .","code":""},{"path":"https://ncahill89.github.io/EIVmodels/articles/CPTutorial.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Bayesian Errors-in-Variables Change-Point Linear Regression","text":"Later use ggplot tidybayes packages, make sure load .","code":"library(EIVmodels) library(tidybayes) library(ggplot2)"},{"path":"https://ncahill89.github.io/EIVmodels/articles/CPTutorial.html","id":"model-specification","dir":"Articles","previous_headings":"","what":"Model specification","title":"Bayesian Errors-in-Variables Change-Point Linear Regression","text":"comes model specification recipe, ingredients process model, relates expectation ’s underlying observed data. process model governed set parameters need estimated. data model, contains assumptions data generated incorporates data uncertainty. data model links observed data underlying process. Priors, contain assumptions parameters estimating. Priors can used impose constraints model parameters based apriori information. process model specification, ’ll assume expected value observed outcome, \\(y\\), changing linear relationship expected x, \\(\\mu_x\\), \\(\\mu_y = \\alpha + \\beta_1(\\mu_x - cp) \\hspace{2em} \\text{} \\mu_x < cp\\) \\(\\mu_y = \\alpha + \\beta_2(\\mu_x - cp) \\hspace{2em} \\text{} \\mu_x \\geq cp\\) words, linear relationship \\(\\mu_x\\) (expected value x) \\(mu_y\\) changes time point (cp). measurements \\(x\\) related \\(\\mu_x\\) via normal distribution \\(x \\sim N(\\mu_x,x_{err}^2)\\) \\(x_{err}\\) observed measurement errors. Note, subtracting change point (cp) \\(\\mu_x\\) regression equation can interpret intercept (\\(\\alpha\\)) expected value y point change point occurs. data model ’ll link observations process normal data model. \\(y \\sim N(\\mu_y, \\sigma^2)\\) measurement error ys , ’ll call \\(y_{err}\\), can update data model \\(y \\sim N(\\mu_y, \\sigma^2 + y_{err}^2)\\) priors need priors unknown parameters. prior change point constrain change point occur somewhere within range observation years. interested digging deeper model specification, JAGS specification particular model, otherwise feel free ignore next part move straight Simulate data section. Notes model setup: setup makes use step function JAGS decide \\(\\beta_1\\) \\(\\beta_2\\) required, step(x) = 1 \\(x\\geq 0\\) 0 otherwise. Normal distributions JAGS always specified precision parameter precision = 1/variance. ’ve add prediction step JAGS model get model-based predictions grid x values (\\(x_{pred}\\)).","code":"cp_model <- 'model{    ## data model     for(j in 1:n_obs)   {   y[j]~dnorm(mu_y[j],tau[j])   mu_y[j] <- alpha + beta[C[j]]*(mu_x[j]-cp)   C[j] <- 1+step(mu_x[j]-cp)      x[j] ~ dnorm(mu_x[j],x_err[j]^-2)   mu_x[j] ~ dnorm(0,0.5^-2)      tau[j] <- (y_err[j]^2 + sigma^2)^-1   }    ##Priors   alpha[1] ~ dnorm(0.0,10^-2)    beta[1]~dnorm(0.0,10^-2)   beta[2]~dnorm(0.0,10^-2)    sigma ~ dt(0,4^-2,1)T(0,)    cp ~ dunif(x_min,x_max)    for(i in 1:n_pred)   {   mu_pred[i] <-alpha + beta[Cstar[i]]*(x_pred[i]-cp)   Cstar[i] <- 1+step(x_pred[i]-cp)   } } '"},{"path":"https://ncahill89.github.io/EIVmodels/articles/CPTutorial.html","id":"simulate-data","dir":"Articles","previous_headings":"","what":"Simulate data","title":"Bayesian Errors-in-Variables Change-Point Linear Regression","text":"One best ways get feel model ’s limitations use simulations. can use EIVmodels package simulate data, measurement errors, single change point. ’m simulating 50 data points x ranges 0 2 (default), change point occurs value \\(x = 1\\), slope = 1.1 change point (\\(\\beta_1\\)) 0.1 change point (\\(\\beta_2\\)) . measurement errors \\(y\\) \\(x\\) set 0.1 0.2 respectively. output data contain simulated \\(x\\), \\(y\\) data well measurement errors supplied. also contain “true” underlying process, can used comparison purposes later. ’s can play around simulation changing parameter values get different datasets varying characteristics. Now, plot simulated data add true underlying process generated \\(y\\). fit change-point regression model trying estimate “Truth” line.","code":"cp_dat <- sim_cp(n_sim = 50,                  alpha = 0,                  beta = c(1.1,0.1),                  cp = 1,                  y_err = 0.1,                  x_err = 0.2) cp_dat ## # A tibble: 50 × 6 ##        x x_err        y y_err  true_y true_x ##    <dbl> <dbl>    <dbl> <dbl>   <dbl>  <dbl> ##  1 0.955   0.2  0.231     0.1  0.0106  1.11  ##  2 1.49    0.2 -0.0555    0.1  0.0797  1.80  ##  3 0.269   0.2 -0.593     0.1 -0.591   0.463 ##  4 1.37    0.2  0.0493    0.1  0.0454  1.45  ##  5 1.45    0.2  0.00792   0.1  0.0399  1.40  ##  6 0.453   0.2 -0.258     0.1 -0.161   0.853 ##  7 1.66    0.2  0.0786    0.1  0.0615  1.61  ##  8 1.95    0.2  0.0856    0.1  0.0708  1.71  ##  9 0.981   0.2 -0.232     0.1 -0.236   0.785 ## 10 2.15    0.2  0.172     0.1  0.0911  1.91  ## # … with 40 more rows plot_dat(cp_dat,          add_truth = TRUE)"},{"path":"https://ncahill89.github.io/EIVmodels/articles/CPTutorial.html","id":"run-the-eiv-1-change-point-regression-model","dir":"Articles","previous_headings":"","what":"Run the EIV 1-change-point regression model","title":"Bayesian Errors-in-Variables Change-Point Linear Regression","text":"Now ’re going pretend simulated data real life data (.e., don’t know parameter values). want run model estimate parameters. can compare true values parameters posterior distribution parameters see model performs. can use EIVmodels package fit EIV change-point regression model using run_mod function. Specify model argument `model = “cp”.","code":"mod_eiv_cp <- run_mod(cp_dat,                       model = \"cp\") ## module glm loaded ## Compiling model graph ##    Resolving undeclared variables ##    Allocating nodes ## Graph information: ##    Observed stochastic nodes: 100 ##    Unobserved stochastic nodes: 55 ##    Total graph size: 924 ##  ## Initializing model ## No convergence issues detected"},{"path":"https://ncahill89.github.io/EIVmodels/articles/CPTutorial.html","id":"results","dir":"Articles","previous_headings":"","what":"Results","title":"Bayesian Errors-in-Variables Change-Point Linear Regression","text":"can plot results (add true line) using plot_res function follows:  access parameter summaries model need run par_est function. summary, q5 q95 provide upper lower bounds 90% uncertainty intervals. Note whether 90% uncertainty intervals contain true parameter values. like get detailed look posterior distributions parameters can pull posterior samples model object created can use tidybayes package create plots. First, get sample_draws contains posterior samples parameters model-based estimates expected value y. Now let’s look posterior distributions \\(\\beta_1\\) \\(\\beta_2\\) change-point (cp). ’ll use stat_halfeye() function tidybayes package.","code":"plot_res(mod_eiv_cp,          add_truth = TRUE) mod_cp_res <- par_est(mod = mod_eiv_cp) mod_cp_res$par_summary ## # A tibble: 5 × 10 ##   variable     mean   median     sd    mad       q5    q95  rhat ess_bulk ##   <chr>       <dbl>    <dbl>  <dbl>  <dbl>    <dbl>  <dbl> <dbl>    <dbl> ## 1 alpha    -0.00549 -0.00143 0.0832 0.0747 -0.139   0.123  0.999     886. ## 2 beta[1]   0.890    0.875   0.118  0.112   0.726   1.09   1.00      811. ## 3 beta[2]   0.122    0.141   0.149  0.126  -0.118   0.318  0.999     924. ## 4 cp        0.971    0.963   0.154  0.147   0.736   1.23   1.00      888. ## 5 sigma     0.0312   0.0271  0.0226 0.0229  0.00308 0.0742 1.00      859. ## # … with 1 more variable: ess_tail <dbl> mod_eiv_cp$sample_draws ## # A tibble: 3,000 × 59 ##    .chain .iteration .draw   alpha `beta[1]` `beta[2]`    cp deviance ##     <int>      <int> <int>   <dbl>     <dbl>     <dbl> <dbl>    <dbl> ##  1      1          1     1 -0.0919     1.02     0.248  0.771    -78.7 ##  2      1          2     2  0.0369     0.935   -0.0361 0.978    -94.2 ##  3      1          3     3  0.120      0.752    0.157  1.26     -82.7 ##  4      1          4     4 -0.195      1.11     0.296  0.584    -70.3 ##  5      1          5     5 -0.0584     0.825    0.285  0.967    -95.0 ##  6      1          6     6 -0.0139     0.778    0.175  1.00     -97.8 ##  7      1          7     7  0.0459     0.790    0.121  1.07     -92.2 ##  8      1          8     8  0.0827     0.660   -0.0874 1.21     -78.1 ##  9      1          9     9 -0.0528     0.766    0.155  0.959   -104.  ## 10      1         10    10 -0.0248     0.902    0.260  0.967   -101.  ## # … with 2,990 more rows, and 51 more variables: `mu_pred[1]` <dbl>, ## #   `mu_pred[2]` <dbl>, `mu_pred[3]` <dbl>, `mu_pred[4]` <dbl>, ## #   `mu_pred[5]` <dbl>, `mu_pred[6]` <dbl>, `mu_pred[7]` <dbl>, ## #   `mu_pred[8]` <dbl>, `mu_pred[9]` <dbl>, `mu_pred[10]` <dbl>, ## #   `mu_pred[11]` <dbl>, `mu_pred[12]` <dbl>, `mu_pred[13]` <dbl>, ## #   `mu_pred[14]` <dbl>, `mu_pred[15]` <dbl>, `mu_pred[16]` <dbl>, ## #   `mu_pred[17]` <dbl>, `mu_pred[18]` <dbl>, `mu_pred[19]` <dbl>, … ggplot(mod_eiv_cp$sample_draws, aes(x = `beta[1]`)) +   tidybayes::stat_halfeye() ggplot(mod_eiv_cp$sample_draws, aes(x = `beta[2]`)) +   tidybayes::stat_halfeye() ggplot(mod_eiv_cp$sample_draws, aes(x = cp)) +   tidybayes::stat_halfeye()"},{"path":"https://ncahill89.github.io/EIVmodels/articles/CPTutorial.html","id":"what-if-we-didnt-assume-the-eiv-component-in-the-model","dir":"Articles","previous_headings":"","what":"What if we didn’t assume the EIV component in the model?","title":"Bayesian Errors-in-Variables Change-Point Linear Regression","text":"wish ignore EIV component change-point model can use run_mod function EIVmodels package specify EIV = FALSE. can compare models truth.","code":"mod_cp <- run_mod(cp_dat,                   model = \"cp\",                   EIV = FALSE) ## Compiling model graph ##    Resolving undeclared variables ##    Allocating nodes ## Graph information: ##    Observed stochastic nodes: 50 ##    Unobserved stochastic nodes: 5 ##    Total graph size: 809 ##  ## Initializing model ## No convergence issues detected plot_res(mod_cp,          mod_eiv_cp,          add_truth = TRUE)"},{"path":"https://ncahill89.github.io/EIVmodels/articles/CPTutorial.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Bayesian Errors-in-Variables Change-Point Linear Regression","text":"starting point developing Bayesian change-point regression models time dependent data measurement error. Using simulated data can helpful checking model expect .","code":""},{"path":"https://ncahill89.github.io/EIVmodels/articles/eivmodels.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Introduction to EIVmodels","text":"","code":"library(EIVmodels)"},{"path":"https://ncahill89.github.io/EIVmodels/articles/eivmodels.html","id":"example---simple-linear-regression","dir":"Articles","previous_headings":"","what":"Example - Simple Linear Regression","title":"Introduction to EIVmodels","text":"package provides options simulate data different types models measurement error x y variable. ’ll start simulating data linear regression model measurement error. default range \\(x\\) 0 2. ’m simulating 20 data points intercept (\\(\\alpha\\)) = 0, slope (\\(\\beta\\)) = 1. measurement errors \\(y\\) \\(x\\) set 0.1. output data contains simulated \\(x\\), \\(y\\) data well measurement errors supplied. also contain “true” underlying process, can used comparison purposes later. Next ’ll plot simulated data ’ll add true regression line plot adding argument add_truth = TRUE plot_dat() function.  Now ’ll fit errors--variables simple linear regression model data see close get estimating true data generating process. ’ll start creating model object specifying argument model = \"slr\". ’ll see messages progress bar pop JAGS model starts run. Now ’ll plot model-based estimates uncertainty. ’ll overlay “true” line comparison.  access data created plot, use: access summary parameter estimates, use:","code":"dat <- sim_slr(n_sim = 20,                alpha = 0,                beta = 1,                y_err = 0.1,                x_err = 0.1) dat ## # A tibble: 20 × 6 ##          x x_err      y y_err true_y true_x ##      <dbl> <dbl>  <dbl> <dbl>  <dbl>  <dbl> ##  1 0.902     0.1 0.686    0.1 0.832  0.832  ##  2 1.22      0.1 1.08     0.1 1.15   1.15   ##  3 1.37      0.1 1.23     0.1 1.28   1.28   ##  4 0.392     0.1 0.338    0.1 0.371  0.371  ##  5 0.697     0.1 0.779    0.1 0.726  0.726  ##  6 1.34      0.1 1.24     0.1 1.30   1.30   ##  7 1.16      0.1 1.37     0.1 1.23   1.23   ##  8 0.307     0.1 0.146    0.1 0.285  0.285  ##  9 0.981     0.1 0.894    0.1 0.986  0.986  ## 10 0.148     0.1 0.0142   0.1 0.0180 0.0180 ## 11 0.751     0.1 0.828    0.1 0.803  0.803  ## 12 0.699     0.1 0.873    0.1 0.805  0.805  ## 13 1.89      0.1 1.91     0.1 1.97   1.97   ## 14 1.57      0.1 1.47     0.1 1.61   1.61   ## 15 0.00428   0.1 0.125    0.1 0.0891 0.0891 ## 16 1.72      0.1 1.82     0.1 1.79   1.79   ## 17 0.620     0.1 0.683    0.1 0.639  0.639  ## 18 0.837     0.1 0.836    0.1 0.909  0.909  ## 19 1.60      0.1 1.59     0.1 1.67   1.67   ## 20 0.239     0.1 0.643    0.1 0.304  0.304 plot_dat(dat,          add_truth = TRUE) mod_eiv_slr <- run_mod(dat,                        model = \"slr\") ## module glm loaded ## Compiling model graph ##    Resolving undeclared variables ##    Allocating nodes ## Graph information: ##    Observed stochastic nodes: 40 ##    Unobserved stochastic nodes: 23 ##    Total graph size: 310 ##  ## Initializing model ## No convergence issues detected plot_res(mod_eiv_slr,          add_truth = TRUE) mod_reg_res <- par_est(mod = mod_eiv_slr) mod_reg_res$pred_summary ## # A tibble: 50 × 4 ##          x pred_y   lwr_95 upr_95 ##      <dbl>  <dbl>    <dbl>  <dbl> ##  1 0.00428 0.0599 -0.0884   0.190 ##  2 0.0428  0.0980 -0.0463   0.222 ##  3 0.0814  0.136  -0.00322  0.257 ##  4 0.120   0.174   0.0389   0.292 ##  5 0.158   0.211   0.0820   0.326 ##  6 0.197   0.249   0.123    0.359 ##  7 0.236   0.287   0.165    0.393 ##  8 0.274   0.325   0.209    0.428 ##  9 0.313   0.363   0.251    0.461 ## 10 0.351   0.401   0.293    0.495 ## # … with 40 more rows mod_reg_res$par_summary ## # A tibble: 3 × 3 ##   variable   `2.5%` `97.5%` ##   <chr>       <dbl>   <dbl> ## 1 alpha    -0.0931    0.186 ## 2 beta      0.851     1.13  ## 3 sigma     0.00372   0.181"},{"path":"https://ncahill89.github.io/EIVmodels/articles/eivmodels.html","id":"example---using-real-data","dir":"Articles","previous_headings":"","what":"Example - Using real data","title":"Introduction to EIVmodels","text":"package contains dataset called NJ_CC subset sea level reconstruction New Jersey, USA (details full record can found paper). Note format dataset. format use data want apply models . Let’s plot data","code":"EIVmodels::NJ_CC ## # A tibble: 50 × 4 ##        x     y y_err x_err ##    <dbl> <dbl> <dbl> <dbl> ##  1  1509 -1.13  0.08  21   ##  2  1521 -1.12  0.07  20   ##  3  1532 -1.1   0.07  19   ##  4  1594 -1.05  0.06  15   ##  5  1604 -1     0.09  15   ##  6  1612 -0.97  0.09  13.5 ##  7  1645 -0.91  0.13   7.5 ##  8  1661 -0.91  0.09   6   ##  9  1687 -0.88  0.11  11   ## 10  1700 -0.85  0.11  11.5 ## # … with 40 more rows plot_dat(NJ_CC)"},{"path":"https://ncahill89.github.io/EIVmodels/articles/eivmodels.html","id":"eiv-simple-linear-regression","dir":"Articles","previous_headings":"Example - Using real data","what":"EIV simple linear regression","title":"Introduction to EIVmodels","text":"Let’s fit EIV simple linear regression model. data good idea scale age data. Dividing 1000 useful , relative sea level data (\\(y\\)) metres, dividing 1000 means slope (rate change) still easily interpreted relation original scale data. case slope can interpreted mm/yr. Let’s get parameter estimates Based model, rate sea level change 1.9 mm/yr (90% UI: 1.7 2.1 mm/yr) Now, let’s visualise results","code":"mod_eiv_slr <- run_mod(NJ_CC,                        model = \"slr\",                        scale_factor = 1000) ## Compiling model graph ##    Resolving undeclared variables ##    Allocating nodes ## Graph information: ##    Observed stochastic nodes: 100 ##    Unobserved stochastic nodes: 53 ##    Total graph size: 582 ##  ## Initializing model ## No convergence issues detected mod_reg_res <- par_est(mod = mod_eiv_slr) mod_reg_res$par_summary ## # A tibble: 3 × 3 ##   variable    `2.5%` `97.5%` ##   <chr>        <dbl>   <dbl> ## 1 alpha    -4.47     -3.67   ## 2 beta      1.69      2.13   ## 3 sigma     0.000554  0.0486 plot_res(mod_eiv_slr)"},{"path":"https://ncahill89.github.io/EIVmodels/articles/eivmodels.html","id":"eiv-change-point-linear-regression","dir":"Articles","previous_headings":"Example - Using real data","what":"EIV change-point linear regression","title":"Introduction to EIVmodels","text":"Let’s fit EIV change point linear regression model instead. need change model argument “cp”. Let’s get parameter estimates Now, let’s visualise results","code":"mod_eiv_cp <- run_mod(NJ_CC,                        model = \"cp\",                        scale_factor = 1000) ## Compiling model graph ##    Resolving undeclared variables ##    Allocating nodes ## Graph information: ##    Observed stochastic nodes: 100 ##    Unobserved stochastic nodes: 55 ##    Total graph size: 986 ##  ## Initializing model ## No convergence issues detected mod_cp_res <- par_est(mod = mod_eiv_cp) mod_cp_res$par_summary ## # A tibble: 5 × 10 ##   variable    mean  median     sd    mad        q5     q95  rhat ess_bulk ##   <chr>      <dbl>   <dbl>  <dbl>  <dbl>     <dbl>   <dbl> <dbl>    <dbl> ## 1 alpha    -0.692  -0.623  0.256  0.188  -1.19     -0.373  0.999    1034. ## 2 beta[1]   0.884   1.47   2.45   0.308  -3.61      1.87   1.00      909. ## 3 beta[2]   3.93    3.39   2.29   1.26    1.93      7.84   0.999    1076. ## 4 cp        1.81    1.86   0.139  0.0764  1.52      1.96   0.999    1051. ## 5 sigma     0.0148  0.0124 0.0114 0.0111  0.000902  0.0367 1.00      873. ## # … with 1 more variable: ess_tail <dbl> plot_res(mod_eiv_cp)"},{"path":"https://ncahill89.github.io/EIVmodels/articles/eivmodels.html","id":"eiv-gaussian-process","dir":"Articles","previous_headings":"Example - Using real data","what":"EIV Gaussian Process","title":"Introduction to EIVmodels","text":"Let’s fit EIV Gaussian process model. take longer run others (25 minutes NJ_CC data). Rates provided model approximated using method finite differences. rates interest recommended use EIV Integrated Gaussian Process model instead. Let’s visualise results   Let’s look output creates results plots Let’s check parameter estimates","code":"mod_eiv_gp <- run_mod(NJ_CC,                        model = \"gp\",                        scale_factor = 1000) plot_res(mod_eiv_gp) ## $p ##  ## $p_rate mod_gp_res <- par_est(mod = mod_eiv_gp) mod_gp_res$pred_summary ## # A tibble: 50 × 7 ##        x pred_y lwr_95 upr_95 rate_y rate_lwr_95 rate_upr_95 ##    <dbl>  <dbl>  <dbl>  <dbl>  <dbl>       <dbl>       <dbl> ##  1 1509   -1.09  -1.24 -0.931  0.478     -0.961         1.72 ##  2 1519.  -1.08  -1.23 -0.937  0.505     -0.899         1.73 ##  3 1529.  -1.08  -1.21 -0.942  0.554     -0.759         1.71 ##  4 1539.  -1.07  -1.20 -0.945  0.607     -0.621         1.73 ##  5 1549.  -1.07  -1.19 -0.946  0.652     -0.496         1.74 ##  6 1559.  -1.06  -1.17 -0.947  0.701     -0.358         1.75 ##  7 1569.  -1.05  -1.16 -0.946  0.752     -0.227         1.74 ##  8 1578.  -1.04  -1.15 -0.943  0.813     -0.0980        1.75 ##  9 1588.  -1.04  -1.13 -0.939  0.875      0.0180        1.76 ## 10 1598.  -1.03  -1.12 -0.934  0.931      0.129         1.79 ## # … with 40 more rows mod_gp_res$par_summary ## # A tibble: 4 × 10 ##   variable   mean  median     sd    mad       q5    q95  rhat ess_bulk ess_tail ##   <chr>     <dbl>   <dbl>  <dbl>  <dbl>    <dbl>  <dbl> <dbl>    <dbl>    <dbl> ## 1 alpha    0.545  -0.0188 3.18   1.80   -3.43    6.29    1.00     957.     943. ## 2 phi      1.23    0.993  0.814  0.585   0.404   2.85    1.00     930.     890. ## 3 sigma    0.0148  0.0123 0.0113 0.0105  0.00123 0.0381  1.01     837.     909. ## 4 sigma_g  3.21    2.43   2.77   1.88    0.610   8.82    1.01     985.     896."},{"path":"https://ncahill89.github.io/EIVmodels/articles/eivmodels.html","id":"eiv-integrated-gaussian-process","dir":"Articles","previous_headings":"Example - Using real data","what":"EIV Integrated Gaussian Process","title":"Introduction to EIVmodels","text":"Let’s fit EIV integrated Gaussian process model. much richer model also take longer run simpler models (~ 12 minutes NJ_CC dataset). However, advantage provides underlying rate process directly model. Details model can found paper. Let’s visualise results   Let’s look output creates results plots Let’s check parameter estimates","code":"mod_eiv_igp <- run_mod(NJ_CC,                        model = \"igp\",                        scale_factor = 1000) plot_res(mod_eiv_igp) ## $p ##  ## $p_rate mod_igp_res <- par_est(mod = mod_eiv_igp) mod_igp_res$pred_summary ## # A tibble: 50 × 7 ##        x pred_y lwr_95 upr_95 rate_y rate_lwr_95 rate_upr_95 ##    <dbl>  <dbl>  <dbl>  <dbl>  <dbl>       <dbl>       <dbl> ##  1 1509   -1.12  -1.21 -1.03   0.953     -0.193         2.00 ##  2 1519.  -1.11  -1.19 -1.02   0.977     -0.119         1.97 ##  3 1529.  -1.10  -1.18 -1.02   0.996     -0.0295        1.94 ##  4 1539.  -1.09  -1.16 -1.02   1.02       0.0464        1.90 ##  5 1549.  -1.08  -1.15 -1.02   1.05       0.133         1.87 ##  6 1559.  -1.07  -1.14 -1.01   1.08       0.217         1.84 ##  7 1569.  -1.06  -1.12 -1.01   1.11       0.292         1.84 ##  8 1578.  -1.05  -1.11 -0.994  1.14       0.378         1.85 ##  9 1588.  -1.04  -1.09 -0.985  1.17       0.453         1.83 ## 10 1598.  -1.03  -1.08 -0.973  1.20       0.542         1.82 ## # … with 40 more rows mod_igp_res$par_summary ## # A tibble: 3 × 10 ##   variable   mean median     sd    mad      q5    q95  rhat ess_bulk ess_tail ##   <chr>     <dbl>  <dbl>  <dbl>  <dbl>   <dbl>  <dbl> <dbl>    <dbl>    <dbl> ## 1 phi      0.163  0.153  0.0998 0.102  0.0302  0.347  1.00     1042.     931. ## 2 sigma    0.0148 0.0130 0.0112 0.0121 0.00104 0.0358 1.00     1000.    1026. ## 3 sigma_g  2.67   2.30   1.59   1.29   0.809   5.77   0.999     943.     983."},{"path":"https://ncahill89.github.io/EIVmodels/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Niamh Cahill. Author, maintainer.","code":""},{"path":"https://ncahill89.github.io/EIVmodels/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Cahill N (2022). EIVmodels: Fit Errors--variables regression model. R package version 0.1.0, https://ncahill89.github.io/EIVmodels/.","code":"@Manual{,   title = {EIVmodels: Fit Errors-in-variables regression model},   author = {Niamh Cahill},   year = {2022},   note = {R package version 0.1.0},   url = {https://ncahill89.github.io/EIVmodels/}, }"},{"path":"https://ncahill89.github.io/EIVmodels/index.html","id":"eivmodels","dir":"","previous_headings":"","what":"Fit Errors-in-variables regression model","title":"Fit Errors-in-variables regression model","text":"statistics, errors--variables (EIV) models, measurement error models, models account measurement errors independent (predictor) dependent (outcome) variables. EIVmodels R package designed specifically account measurement errors within commonly used models (linear regression, change-point regression, (Integrated) Gaussian process regression) analysing time-dependent data derived paleoenvironmental reconstructions.models implemented Bayesian framework using JAGS (Just Another Gibbs Sampler) software.","code":""},{"path":"https://ncahill89.github.io/EIVmodels/index.html","id":"requirements","dir":"","previous_headings":"","what":"Requirements","title":"Fit Errors-in-variables regression model","text":"package requires installation JAGS software. Click download JAGS.","code":""},{"path":"https://ncahill89.github.io/EIVmodels/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting started","title":"Fit Errors-in-variables regression model","text":"See Vignettes.","code":""},{"path":"https://ncahill89.github.io/EIVmodels/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Fit Errors-in-variables regression model","text":"package currently cran can download Github. Make sure devtools package installed execute following:","code":"devtools::install_github(\"ncahill89/EIVmodels\")"},{"path":"https://ncahill89.github.io/EIVmodels/reference/NJ_CC.html","id":null,"dir":"Reference","previous_headings":"","what":"A sea level reconstruction from New Jersey, USA. — NJ_CC","title":"A sea level reconstruction from New Jersey, USA. — NJ_CC","text":"dataset containing relative sea level (RSL) reconstruction, RSL error, age reconstruction agg error","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/NJ_CC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A sea level reconstruction from New Jersey, USA. — NJ_CC","text":"","code":"NJ_CC"},{"path":"https://ncahill89.github.io/EIVmodels/reference/NJ_CC.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A sea level reconstruction from New Jersey, USA. — NJ_CC","text":"data frame 50 rows 4 variables: x age, year CE y relative sea level metres x_err age error y_err RSL error","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/NJ_CC.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A sea level reconstruction from New Jersey, USA. — NJ_CC","text":"https://cp.copernicus.org/articles/12/525/2016/","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/par_est.html","id":null,"dir":"Reference","previous_headings":"","what":"Get parameter estimates and model estimates — par_est","title":"Get parameter estimates and model estimates — par_est","text":"Get parameter estimates model estimates","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/par_est.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get parameter estimates and model estimates — par_est","text":"","code":"par_est(mod)"},{"path":"https://ncahill89.github.io/EIVmodels/reference/par_est.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get parameter estimates and model estimates — par_est","text":"mod Fitted model object run_mod","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/par_est.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get parameter estimates and model estimates — par_est","text":"List model estimates (pred_summary) parameter estimates (par_summary)","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/par_est.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get parameter estimates and model estimates — par_est","text":"","code":"dat <- sim_slr(n_sim = 30) mod <- run_mod(dat, model = \"slr\") #> module glm loaded #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 60 #>    Unobserved stochastic nodes: 33 #>    Total graph size: 380 #>  #> Initializing model #>  #> No convergence issues detected par_est(mod) #> $pred_summary #> # A tibble: 50 × 4 #>          x  pred_y  lwr_95 upr_95 #>      <dbl>   <dbl>   <dbl>  <dbl> #>  1 -0.101  -0.0782 -0.215  0.0491 #>  2 -0.0584 -0.0329 -0.166  0.0894 #>  3 -0.0159  0.0126 -0.118  0.129  #>  4  0.0266  0.0578 -0.0696 0.170  #>  5  0.0691  0.103  -0.0201 0.210  #>  6  0.112   0.148   0.0298 0.250  #>  7  0.154   0.192   0.0769 0.290  #>  8  0.197   0.237   0.127  0.332  #>  9  0.239   0.282   0.178  0.371  #> 10  0.282   0.327   0.226  0.412  #> # … with 40 more rows #>  #> $par_summary #> # A tibble: 3 × 3 #>   variable  `2.5%` `97.5%` #>   <chr>      <dbl>   <dbl> #> 1 alpha    -0.0998   0.144 #> 2 beta      0.932    1.18  #> 3 sigma     0.0301   0.211 #>"},{"path":"https://ncahill89.github.io/EIVmodels/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://ncahill89.github.io/EIVmodels/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling `rhs(lhs)`.","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/plot_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot data with measurement uncertainty (in y and x variables) — plot_dat","title":"Plot data with measurement uncertainty (in y and x variables) — plot_dat","text":"Plot data measurement uncertainty (y x variables)","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/plot_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot data with measurement uncertainty (in y and x variables) — plot_dat","text":"","code":"plot_dat(dat, add_truth = FALSE)"},{"path":"https://ncahill89.github.io/EIVmodels/reference/plot_dat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot data with measurement uncertainty (in y and x variables) — plot_dat","text":"dat Input data columns x,x_err,y,y_err add_truth Logical argument add \"True\" data generating process plot. set True using simulated data sim_slr, sim_cp sim_gp.","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/plot_dat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot data with measurement uncertainty (in y and x variables) — plot_dat","text":"Plot data measurement errors","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/plot_dat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot data with measurement uncertainty (in y and x variables) — plot_dat","text":"","code":"dat <- sim_slr(n_sim = 30) plot_dat(dat)"},{"path":"https://ncahill89.github.io/EIVmodels/reference/plot_res.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot of data plus model estimates (and credible intervals) — plot_res","title":"Plot of data plus model estimates (and credible intervals) — plot_res","text":"Plot data plus model estimates (credible intervals)","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/plot_res.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot of data plus model estimates (and credible intervals) — plot_res","text":"","code":"plot_res(mod1, mod2 = NULL, add_truth = FALSE)"},{"path":"https://ncahill89.github.io/EIVmodels/reference/plot_res.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot of data plus model estimates (and credible intervals) — plot_res","text":"mod1 fitted model run_mod mod2 optional second fitted model run_mod comparison add_truth Logical argument add \"True\" data generating process plot. set True using simulated data sim_dat","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/plot_res.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot of data plus model estimates (and credible intervals) — plot_res","text":"p","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/plot_res.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot of data plus model estimates (and credible intervals) — plot_res","text":"","code":"dat <- sim_slr(n_sim = 30) mod <- run_mod(dat, model = \"slr\") #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 60 #>    Unobserved stochastic nodes: 33 #>    Total graph size: 380 #>  #> Initializing model #>  #> No convergence issues detected plot_res(mod)"},{"path":"https://ncahill89.github.io/EIVmodels/reference/run_mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit errors-in-variables models with JAGS — run_mod","title":"Fit errors-in-variables models with JAGS — run_mod","text":"Fit errors--variables models JAGS","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/run_mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit errors-in-variables models with JAGS — run_mod","text":"","code":"run_mod(   dat,   model = \"slr\",   EIV = TRUE,   n_cp = 1,   igp_smooth = 0.2,   iter = 5000,   burnin = 1000,   thin = 4,   scale_factor = 1 )"},{"path":"https://ncahill89.github.io/EIVmodels/reference/run_mod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit errors-in-variables models with JAGS — run_mod","text":"dat Input data columns x,x_err,y,y_err model model run. Choose slr, cp, gp, igp EIV Indicate whether use EIV framework. Defaults TRUE n_cp Number change points model = \"cp\" chosen. Can choose 1,2,3,4. igp_smooth Informs prior smoothness (correlation) parameter model = \"igp\" chosen. Choose value 0 1. Closer 1 increase smoothness. iter MCMC iterations burnin MCMC burnin thin MCMC thinning scale_factor value divide predictor (x) change scale. 1 result n0 change. 1000 recommended x years.","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/run_mod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit errors-in-variables models with JAGS — run_mod","text":"List data, JAGS input data, model output name model file.","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/run_mod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit errors-in-variables models with JAGS — run_mod","text":"","code":"dat <- sim_slr(n_sim = 30) mod <- run_mod(dat, model = \"slr\") #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 60 #>    Unobserved stochastic nodes: 33 #>    Total graph size: 380 #>  #> Initializing model #>  #> No convergence issues detected"},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_cp.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate data with measurment error from a change-point linear regression — sim_cp","title":"Simulate data with measurment error from a change-point linear regression — sim_cp","text":"Simulate data measurment error change-point linear regression","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_cp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate data with measurment error from a change-point linear regression — sim_cp","text":"","code":"sim_cp(   n_sim = 50,   min_x = 0,   max_x = 2,   alpha = 0,   beta = c(1, 2),   cp = 1,   sigma = 0.1,   x_err = 0.1,   y_err = 0.1 )"},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_cp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate data with measurment error from a change-point linear regression — sim_cp","text":"n_sim Number data points simulate min_x Minimum x value max_x Maximum x value alpha Regression intercept beta Regression slope cp Change point sigma Nugget variation x_err x measurement error y_err y measurement error","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_cp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate data with measurment error from a change-point linear regression — sim_cp","text":"Simulated dataset columns x, x_err, y, y_err","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_cp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate data with measurment error from a change-point linear regression — sim_cp","text":"","code":"sim_cp(n_sim = 50) #> # A tibble: 50 × 6 #>         x x_err       y y_err  true_y true_x #>     <dbl> <dbl>   <dbl> <dbl>   <dbl>  <dbl> #>  1 2.00     0.1  1.95     0.1  1.98   1.99   #>  2 1.07     0.1 -0.0108   0.1 -0.0704 0.930  #>  3 0.397    0.1 -0.302    0.1 -0.438  0.562  #>  4 1.07     0.1  0.208    0.1  0.307  1.15   #>  5 1.57     0.1  1.11     0.1  0.987  1.49   #>  6 0.0117   0.1 -0.867    0.1 -0.978  0.0216 #>  7 1.99     0.1  1.97     0.1  1.91   1.95   #>  8 0.862    0.1 -0.213    0.1 -0.266  0.734  #>  9 0.796    0.1 -0.232    0.1 -0.307  0.693  #> 10 0.547    0.1 -0.340    0.1 -0.401  0.599  #> # … with 40 more rows"},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_gp.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate data with measurment error from a Gaussian process regression — sim_gp","title":"Simulate data with measurment error from a Gaussian process regression — sim_gp","text":"Simulate data measurment error Gaussian process regression","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_gp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate data with measurment error from a Gaussian process regression — sim_gp","text":"","code":"sim_gp(   n_sim = 50,   min_x = 0,   max_x = 2,   alpha = 0,   sigma_g = 2,   phi = 2,   sigma = 0.1,   x_err = 0.1,   y_err = 0.1 )"},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_gp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate data with measurment error from a Gaussian process regression — sim_gp","text":"n_sim number data points simulate min_x Minimum x value max_x Maximum x value alpha regression intercept sigma_g GP variance parameter phi GP correlation parameter sigma nugget variation x_err x measurement error y_err y measurement error","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_gp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate data with measurment error from a Gaussian process regression — sim_gp","text":"Simulated dataset columns x, x_err, y, y_err","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_gp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate data with measurment error from a Gaussian process regression — sim_gp","text":"","code":"sim_gp(n_sim = 50) #> Compiling rjags model... #> Calling the simulation using the rjags method... #> Note: the model did not require adaptation #> Burning in the model for 4000 iterations... #> Running the model for 1 iterations... #> Simulation complete #> Finished running the simulation #> # A tibble: 50 × 6 #>        x x_err      y y_err true_y true_x #>    <dbl> <dbl>  <dbl> <dbl>  <dbl>  <dbl> #>  1 0.425   0.1 -1.22    0.1 -1.25   0.207 #>  2 0.286   0.1 -1.13    0.1 -1.26   0.214 #>  3 0.241   0.1 -1.16    0.1 -1.26   0.223 #>  4 0.122   0.1 -1.56    0.1 -1.26   0.226 #>  5 0.316   0.1 -0.852   0.1 -1.27   0.233 #>  6 0.186   0.1 -1.14    0.1 -1.27   0.254 #>  7 0.402   0.1 -0.970   0.1 -1.23   0.323 #>  8 0.419   0.1 -1.14    0.1 -0.913  0.447 #>  9 0.345   0.1 -1.12    0.1 -0.910  0.448 #> 10 0.510   0.1 -0.879   0.1 -0.810  0.474 #> # … with 40 more rows"},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_slr.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate data with measurment error from a simple linear regression — sim_slr","title":"Simulate data with measurment error from a simple linear regression — sim_slr","text":"Simulate data measurment error simple linear regression","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_slr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate data with measurment error from a simple linear regression — sim_slr","text":"","code":"sim_slr(   n_sim = 50,   min_x = 0,   max_x = 2,   alpha = 0,   beta = 1,   sigma = 0.1,   x_err = 0.1,   y_err = 0.1 )"},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_slr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate data with measurment error from a simple linear regression — sim_slr","text":"n_sim Number data points simulate min_x Minimum x value max_x Maximum x value alpha Regression intercept beta Regression slope sigma Nugget variation x_err x measurement error y_err y measurement error","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_slr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate data with measurment error from a simple linear regression — sim_slr","text":"Simulated dataset columns x, x_err, y, y_err","code":""},{"path":"https://ncahill89.github.io/EIVmodels/reference/sim_slr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate data with measurment error from a simple linear regression — sim_slr","text":"","code":"sim_slr(n_sim = 50) #> # A tibble: 50 × 6 #>        x x_err      y y_err true_y true_x #>    <dbl> <dbl>  <dbl> <dbl>  <dbl>  <dbl> #>  1 0.122   0.1 0.268    0.1  0.186  0.186 #>  2 0.577   0.1 0.468    0.1  0.510  0.510 #>  3 0.330   0.1 0.337    0.1  0.364  0.364 #>  4 1.09    0.1 1.30     0.1  1.25   1.25  #>  5 0.446   0.1 0.289    0.1  0.213  0.213 #>  6 0.800   0.1 1.17     0.1  1.03   1.03  #>  7 1.01    0.1 1.11     0.1  1.09   1.09  #>  8 0.883   0.1 0.722    0.1  0.916  0.916 #>  9 0.424   0.1 0.0772   0.1  0.270  0.270 #> 10 1.74    0.1 1.98     0.1  1.72   1.72  #> # … with 40 more rows"}]
