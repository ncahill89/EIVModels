<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to get started
">
<title>Introduction to EIVmodels • EIVmodels</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to EIVmodels">
<meta property="og:description" content="Learn how to get started
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EIVmodels</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-slides">Slides</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-slides">
    <a class="external-link dropdown-item" href="https://rpubs.com/ncahill_stat/892131">Introduction to Bayesian Models</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/eivmodels.html">Basics</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="external-link dropdown-item" href="https://rpubs.com/ncahill_stat/892178">EIV-CP Regression</a>
    <a class="external-link dropdown-item" href="https://rpubs.com/ncahill_stat/889056">GP Regression</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Documentation</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="eivmodels_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to EIVmodels</h1>
            
      
      
      <div class="d-none name"><code>eivmodels.Rmd</code></div>
    </div>

    
    
<p>The goal of EIVmodels is to fit models accounting for measurement error.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ncahill89.github.io/EIVmodels/">EIVmodels</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example---simple-linear-regression">Example - Simple Linear Regression<a class="anchor" aria-label="anchor" href="#example---simple-linear-regression"></a>
</h2>
<p>This package provides options to simulate data from different types of models where there is measurement error in both the <code>x</code> and <code>y</code> variable. We’ll start by simulating some data from a linear regression model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_slr.html">sim_slr</a></span><span class="op">(</span>n_sim <span class="op">=</span> <span class="fl">10</span>,
               alpha <span class="op">=</span> <span class="fl">0</span>,
               beta <span class="op">=</span> <span class="fl">1</span>,
               x_err <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="va">dat</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 10 × 6</span></span>
<span class="co">##         x x_err     y y_err true_y true_x</span>
<span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> 1.14     0.1 0.892   0.1 1.07   1.07  </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> 0.680    0.1 0.494   0.1 0.549  0.549 </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> 0.972    0.1 0.872   0.1 0.944  0.944 </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> 0.718    0.1 0.841   0.1 0.664  0.664 </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> 1.54     0.1 1.87    0.1 1.85   1.85  </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> 1.69     0.1 1.56    0.1 1.73   1.73  </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> 0.021<span style="text-decoration: underline;">8</span>   0.1 0.133   0.1 0.016<span style="text-decoration: underline;">5</span> 0.016<span style="text-decoration: underline;">5</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> 1.27     0.1 1.39    0.1 1.38   1.38  </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> 0.279    0.1 0.109   0.1 0.213  0.213 </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> 1.98     0.1 1.79    0.1 1.91   1.91</span></code></pre>
<p>Next we’ll plot the simulated data and we’ll add the true regression line to the plot by adding the argument <code>add_truth = TRUE</code> to the <code><a href="../reference/plot_dat.html">plot_dat()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_dat.html">plot_dat</a></span><span class="op">(</span><span class="va">dat</span>,
         add_truth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="eivmodels_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Now we’ll fit the errors-in-variables simple linear regression model to the data and see how close we get to estimating the true data generating process. We’ll start by creating a model object and specifying the argument <code>model = "model_eiv_reg"</code>. You’ll see some messages and a progress bar pop up as the JAGS model starts to run.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_eiv_slr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mod.html">run_mod</a></span><span class="op">(</span><span class="va">dat</span>,
                   model <span class="op">=</span> <span class="st">"model_eiv_slr"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## module glm loaded</span></code></pre>
<pre><code><span class="co">## Compiling model graph</span>
<span class="co">##    Resolving undeclared variables</span>
<span class="co">##    Allocating nodes</span>
<span class="co">## Graph information:</span>
<span class="co">##    Observed stochastic nodes: 20</span>
<span class="co">##    Unobserved stochastic nodes: 13</span>
<span class="co">##    Total graph size: 240</span>
<span class="co">## </span>
<span class="co">## Initializing model</span></code></pre>
<p>Now we’ll plot the model-based estimates with uncertainty. We’ll overlay the true line as a comparison.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_res.html">plot_res</a></span><span class="op">(</span><span class="va">mod_eiv_slr</span>,
         add_truth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="eivmodels_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>To access the data that created this plot, use:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_reg_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/par_est.html">par_est</a></span><span class="op">(</span>mod <span class="op">=</span> <span class="va">mod_eiv_slr</span><span class="op">)</span>
<span class="va">mod_reg_res</span><span class="op">$</span><span class="va">pred_res</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 50 × 4</span></span>
<span class="co">##         x   pred_y   lwr_95 upr_95</span>
<span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> 0.021<span style="text-decoration: underline;">8</span> -<span style="color: #BB0000;">0.003</span><span style="color: #BB0000; text-decoration: underline;">12</span> -<span style="color: #BB0000;">0.289</span>    0.292</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> 0.061<span style="text-decoration: underline;">7</span>  0.038<span style="text-decoration: underline;">6</span>  -<span style="color: #BB0000;">0.241</span>    0.323</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> 0.102   0.079<span style="text-decoration: underline;">8</span>  -<span style="color: #BB0000;">0.191</span>    0.356</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> 0.142   0.121   -<span style="color: #BB0000;">0.143</span>    0.387</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> 0.181   0.163   -<span style="color: #BB0000;">0.093</span><span style="color: #BB0000; text-decoration: underline;">2</span>   0.419</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> 0.221   0.204   -<span style="color: #BB0000;">0.045</span><span style="color: #BB0000; text-decoration: underline;">3</span>   0.449</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> 0.261   0.245    0.005<span style="text-decoration: underline;">04</span>  0.481</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> 0.301   0.287    0.055<span style="text-decoration: underline;">3</span>   0.516</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> 0.341   0.328    0.105    0.550</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> 0.381   0.368    0.153    0.583</span>
<span class="co">## <span style="color: #949494;"># … with 40 more rows</span></span></code></pre>
<p>To access a summary of the parameter estimates, use:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_reg_res</span><span class="op">$</span><span class="va">par_summary</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 7</span></span>
<span class="co">##   .variable  .value  .lower .upper .width .point .interval</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="co">## <span style="color: #BCBCBC;">1</span> alpha     -<span style="color: #BB0000;">0.025</span><span style="color: #BB0000; text-decoration: underline;">7</span> -<span style="color: #BB0000;">0.317</span>   0.275   0.95 median qi       </span>
<span class="co">## <span style="color: #BCBCBC;">2</span> beta       1.03    0.762   1.29    0.95 median qi       </span>
<span class="co">## <span style="color: #BCBCBC;">3</span> sigma      0.156   0.016<span style="text-decoration: underline;">5</span>  0.373   0.95 median qi</span></code></pre>
</div>
<div class="section level2">
<h2 id="example---using-real-data">Example - Using real data<a class="anchor" aria-label="anchor" href="#example---using-real-data"></a>
</h2>
<p>The package contains a dataset called <code>NJ_CC</code> which is subset of a sea level reconstruction from New Jersey, USA. Note the format of the dataset. This is the format you should use for any data you want to apply these models to.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">EIVmodels</span><span class="fu">::</span><span class="va"><a href="../reference/NJ_CC.html">NJ_CC</a></span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 50 × 4</span></span>
<span class="co">##        x     y y_err x_err</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">1</span>509 -<span style="color: #BB0000;">1.13</span>  0.08  21  </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">1</span>521 -<span style="color: #BB0000;">1.12</span>  0.07  20  </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">1</span>532 -<span style="color: #BB0000;">1.1</span>   0.07  19  </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">1</span>594 -<span style="color: #BB0000;">1.05</span>  0.06  15  </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">1</span>604 -<span style="color: #BB0000;">1</span>     0.09  15  </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">1</span>612 -<span style="color: #BB0000;">0.97</span>  0.09  13.5</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">1</span>645 -<span style="color: #BB0000;">0.91</span>  0.13   7.5</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">1</span>661 -<span style="color: #BB0000;">0.91</span>  0.09   6  </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>687 -<span style="color: #BB0000;">0.88</span>  0.11  11  </span>
<span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">1</span>700 -<span style="color: #BB0000;">0.85</span>  0.11  11.5</span>
<span class="co">## <span style="color: #949494;"># … with 40 more rows</span></span></code></pre>
<p>Let’s plot the data</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_dat.html">plot_dat</a></span><span class="op">(</span><span class="va">NJ_CC</span><span class="op">)</span></code></pre></div>
<p><img src="eivmodels_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p><strong>EIV simple linear regression</strong></p>
<p>Let’s fit the EIV simple linear regression model. With these data its a good idea to scale the age data. Dividing my 1000 is useful here, as the relative sea level data (<span class="math inline">\(y\)</span>) is in metres, dividing by 1000 means the slope (rate of change) is still easily interpreted in relation to the original scale of the data. In this case the slope can be interpreted in mm/yr.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_eiv_slr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mod.html">run_mod</a></span><span class="op">(</span><span class="va">NJ_CC</span>,
                       model <span class="op">=</span> <span class="st">"model_eiv_slr"</span>,
                       scale_factor <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Compiling model graph</span>
<span class="co">##    Resolving undeclared variables</span>
<span class="co">##    Allocating nodes</span>
<span class="co">## Graph information:</span>
<span class="co">##    Observed stochastic nodes: 100</span>
<span class="co">##    Unobserved stochastic nodes: 53</span>
<span class="co">##    Total graph size: 582</span>
<span class="co">## </span>
<span class="co">## Initializing model</span></code></pre>
<p>Let’s get the parameter estimates</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_reg_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/par_est.html">par_est</a></span><span class="op">(</span>mod <span class="op">=</span> <span class="va">mod_eiv_slr</span><span class="op">)</span>
<span class="va">mod_reg_res</span><span class="op">$</span><span class="va">par_summary</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 7</span></span>
<span class="co">##   .variable  .value    .lower  .upper .width .point .interval</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="co">## <span style="color: #BCBCBC;">1</span> alpha     -<span style="color: #BB0000;">4.07</span>   -<span style="color: #BB0000;">4.45</span>     -<span style="color: #BB0000;">3.68</span>     0.95 median qi       </span>
<span class="co">## <span style="color: #BCBCBC;">2</span> beta       1.91    1.69      2.12     0.95 median qi       </span>
<span class="co">## <span style="color: #BCBCBC;">3</span> sigma      0.013<span style="text-decoration: underline;">8</span>  0.000<span style="text-decoration: underline;">640</span>  0.047<span style="text-decoration: underline;">9</span>   0.95 median qi</span></code></pre>
<p>Based on this model, the rate of sea level change is 1.9 mm/yr (95% UI: 1.7 to 2.1 mm/yr)</p>
<p>Now, let’s visualise the results</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_res.html">plot_res</a></span><span class="op">(</span><span class="va">mod_eiv_slr</span><span class="op">)</span></code></pre></div>
<p><img src="eivmodels_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p><strong>EIV change-point linear regression</strong></p>
<p>Let’s fit the EIV change point linear regression model instead. All we need to do is change the model argument.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_eiv_cp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mod.html">run_mod</a></span><span class="op">(</span><span class="va">NJ_CC</span>,
                       model <span class="op">=</span> <span class="st">"model_eiv_cp1"</span>,
                       scale_factor <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Compiling model graph</span>
<span class="co">##    Resolving undeclared variables</span>
<span class="co">##    Allocating nodes</span>
<span class="co">## Graph information:</span>
<span class="co">##    Observed stochastic nodes: 100</span>
<span class="co">##    Unobserved stochastic nodes: 55</span>
<span class="co">##    Total graph size: 986</span>
<span class="co">## </span>
<span class="co">## Initializing model</span></code></pre>
<p>Let’s get the parameter estimates</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_cp_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/par_est.html">par_est</a></span><span class="op">(</span>mod <span class="op">=</span> <span class="va">mod_eiv_cp1</span><span class="op">)</span>
<span class="va">mod_cp_res</span><span class="op">$</span><span class="va">par_summary</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 8</span></span>
<span class="co">##   .variable `1:2`  .value    .lower  .upper .width .point .interval</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="co">## <span style="color: #BCBCBC;">1</span> alpha        <span style="color: #BB0000;">NA</span> -<span style="color: #BB0000;">0.602</span>  -<span style="color: #BB0000;">0.920</span>    -<span style="color: #BB0000;">0.338</span>    0.95 median qi       </span>
<span class="co">## <span style="color: #BCBCBC;">2</span> beta          1  1.50    0.796     1.89     0.95 median qi       </span>
<span class="co">## <span style="color: #BCBCBC;">3</span> beta          2  3.57    2.23     10.5      0.95 median qi       </span>
<span class="co">## <span style="color: #BCBCBC;">4</span> cp           <span style="color: #BB0000;">NA</span>  1.87    1.71      1.97     0.95 median qi       </span>
<span class="co">## <span style="color: #BCBCBC;">5</span> sigma        <span style="color: #BB0000;">NA</span>  0.012<span style="text-decoration: underline;">5</span>  0.000<span style="text-decoration: underline;">588</span>  0.042<span style="text-decoration: underline;">2</span>   0.95 median qi</span></code></pre>
<p>Now, let’s visualise the results</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_res.html">plot_res</a></span><span class="op">(</span><span class="va">mod_eiv_cp1</span><span class="op">)</span></code></pre></div>
<p><img src="eivmodels_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p><strong>EIV Integrated Gaussian Process</strong></p>
<p>Let’s fit the EIV integrated Gaussian process model. This is a much richer model and will take longer to run than the others. However, an advantage is that it provides the underlying rate process as well as the sea level process over time.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_eiv_igp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mod.html">run_mod</a></span><span class="op">(</span><span class="va">NJ_CC</span>,
                       model <span class="op">=</span> <span class="st">"model_eiv_igp"</span>,
                       scale_factor <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
<p>Let’s visualise the results</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_res.html">plot_res</a></span><span class="op">(</span><span class="va">mod_eiv_igp</span><span class="op">)</span></code></pre></div>
<p><img src="eivmodels_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>Let’s look at the output that creates these results plots</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_igp_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/par_est.html">par_est</a></span><span class="op">(</span>mod <span class="op">=</span> <span class="va">mod_eiv_igp</span><span class="op">)</span>
<span class="va">mod_igp_res</span><span class="op">$</span><span class="va">pred_res</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 50 × 7</span></span>
<span class="co">##        x pred_y lwr_95 upr_95 rate_y rate_lwr_95 rate_upr_95</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">1</span>509   -<span style="color: #BB0000;">1.13</span>  -<span style="color: #BB0000;">1.22</span> -<span style="color: #BB0000;">1.04</span>   0.982    -<span style="color: #BB0000;">0.110</span>          2.00</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">1</span>519.  -<span style="color: #BB0000;">1.12</span>  -<span style="color: #BB0000;">1.20</span> -<span style="color: #BB0000;">1.04</span>   1.02     -<span style="color: #BB0000;">0.005</span><span style="color: #BB0000; text-decoration: underline;">72</span>        2.00</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">1</span>529.  -<span style="color: #BB0000;">1.11</span>  -<span style="color: #BB0000;">1.19</span> -<span style="color: #BB0000;">1.03</span>   1.04      0.068<span style="text-decoration: underline;">4</span>         1.99</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">1</span>539.  -<span style="color: #BB0000;">1.10</span>  -<span style="color: #BB0000;">1.17</span> -<span style="color: #BB0000;">1.03</span>   1.07      0.157          1.95</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">1</span>549.  -<span style="color: #BB0000;">1.09</span>  -<span style="color: #BB0000;">1.16</span> -<span style="color: #BB0000;">1.02</span>   1.10      0.244          1.96</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">1</span>559.  -<span style="color: #BB0000;">1.08</span>  -<span style="color: #BB0000;">1.14</span> -<span style="color: #BB0000;">1.01</span>   1.12      0.305          1.93</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">1</span>569.  -<span style="color: #BB0000;">1.07</span>  -<span style="color: #BB0000;">1.12</span> -<span style="color: #BB0000;">1.00</span>   1.16      0.373          1.94</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">1</span>578.  -<span style="color: #BB0000;">1.06</span>  -<span style="color: #BB0000;">1.11</span> -<span style="color: #BB0000;">0.995</span>  1.19      0.448          1.94</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">1</span>588.  -<span style="color: #BB0000;">1.04</span>  -<span style="color: #BB0000;">1.10</span> -<span style="color: #BB0000;">0.986</span>  1.21      0.567          1.94</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">1</span>598.  -<span style="color: #BB0000;">1.03</span>  -<span style="color: #BB0000;">1.08</span> -<span style="color: #BB0000;">0.974</span>  1.26      0.631          1.94</span>
<span class="co">## <span style="color: #949494;"># … with 40 more rows</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Niamh Cahill.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
